#update new log return
## calculate new v and sigma
## generate s1
updateLR <- function(newS0, old_LR){
new_return <- log(news0) - old_LR[length(old_LR)]
print(new_return)
print(log(news0))
return(c(old_LR[2:length(old_LR)],new_return))
}
generate_vsigma <-  function(logLR){
values<- c()
values$v = mean(logLR)
values$sigma = sd(logLR)
return(values)
}
gbm_s1 <- function(s0,v , sigma, Deltat){ ## 252
z = rnorm(1)
return(s0 *exp(v*Deltat+sigma*z*sqrt(Deltat)))
}
sim <- c()
tesla_lr_gbm <- tesla_lr
for(i in 1:252){
if(i ==1){
news0 <- tesla_filter$actual_close[n+1]
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma, 1/252)
print(news0)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
}
else{
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma,1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
print(news0)
}
}
print(sim)
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date >= '2021-01-12') %>% filter(Date <'2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
####
#update new log return
## calculate new v and sigma
## generate s1
updateLR <- function(newS0, old_LR){
new_return <- log(news0) - old_LR[length(old_LR)]
return(c(old_LR[2:length(old_LR)],new_return))
}
generate_vsigma <-  function(logLR){
values<- c()
values$v = mean(logLR)
values$sigma = sd(logLR)
return(values)
}
gbm_s1 <- function(s0,v , sigma, Deltat){ ## 252
z = rnorm(1)
return(s0 *exp(v*Deltat+sigma*z*sqrt(Deltat)))
}
sim <- c()
tesla_lr_gbm <- tesla_lr
for(i in 1:252){
if(i ==1){
news0 <- tesla_filter$actual_close[n+1]
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma, 1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
}
else{
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma,1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
print(news0)
}
}
print(sim)
plot(sim)
tesla_filter$actual_close[n+1]
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date >= '2021-01-12') %>% filter(Date <'2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
tesla_lr
tesla_filter$actual_close[n+1]
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date >= '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
tesla_filter$actual_close[n+1]
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date >= '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
####
#update new log return
## calculate new v and sigma
## generate s1
updateLR <- function(newS0, old_LR){
new_return <- log(news0) - old_LR[length(old_LR)]
return(c(old_LR[2:length(old_LR)],new_return))
}
generate_vsigma <-  function(logLR){
values<- c()
values$v = mean(logLR)/(1/252)
values$sigma = sd(logLR)/sqrt(1/252)
return(values)
}
gbm_s1 <- function(s0,v , sigma, Deltat){ ## 252
z = rnorm(1)
return(s0 *exp(v*Deltat+sigma*sqrt(Deltat)*z))
}
sim <- c()
tesla_lr_gbm <- tesla_lr
for(i in 1:252){
if(i ==1){
news0 <- tesla_filter$actual_close[n+1]
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma, 1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
}
else{
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma,1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
print(news0)
}
}
print(sim)
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date >= '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
####
#update new log return
## calculate new v and sigma
## generate s1
updateLR <- function(newS0, old_LR){
new_return <- log(news0) - old_LR[length(old_LR)]
return(c(old_LR[2:length(old_LR)],new_return))
}
generate_vsigma <-  function(logLR){
values<- c()
values$v = mean(logLR)/(1/252)
values$sigma = sd(logLR)/sqrt(1/252)
return(values)
}
gbm_s1 <- function(s0,v , sigma, Deltat){ ## 252
z = rnorm(1)
return(s0 *exp(v*Deltat+sigma*sqrt(Deltat)*z))
}
sim <- c()
tesla_lr_gbm <- tesla_lr
# Initialize
news0 <- tesla_filter$actual_close[n+1]
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma, 1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
for(i in 2:252){
# if(i ==1){
#   news0 <- tesla_filter$actual_close[n+1]
#   val <- generate_vsigma(tesla_lr_gbm)
#   news0 <- gbm_s1(news0,val$v, val$sigma, 1/252)
#   sim <- c(sim, news0)
#   tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
#
# }
# else{
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma,1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
print(news0)
}
print(sim)
gbm_s1 <- function(s0, v, sigma, Deltat){ ## 252
z = rnorm(1)
return(s0 *exp(v*Deltat+sigma*sqrt(Deltat)*z))
}
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date >= '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
tesla_lr
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date >= '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
tesla_lr[length(old_LR)]
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date >= '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
tesla_lr[length(tesla_lr)]
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date >= '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
tesla_lr[2:length(tesla_lr)]
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date >= '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
tesla_lr[3:length(tesla_lr)]
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date >= '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
# tesla_lr[3:length(tesla_lr)]
length(tesla_lr)
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date >= '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
length(tesla_lr)
tesla_filter<- tesla_filter %>% filter(Date > '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
length(tesla_lr)
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date > '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
length(tesla_lr)
####
#update new log return
## calculate new v and sigma
## generate s1
updateLR <- function(newS0, old_LR){
new_return <- log(news0) - old_LR[length(old_LR)]
return(c(old_LR[2:length(old_LR)],new_return))
}
generate_vsigma <-  function(logLR){
values<- c()
values$v = mean(logLR)/(1/252)
values$sigma = sd(logLR)/sqrt(1/252)
return(values)
}
gbm_s1 <- function(s0, v, sigma, Deltat){ ## 252
z = rnorm(1)
return(s0 *exp(v*Deltat+sigma*sqrt(Deltat)*z))
}
sim <- c()
tesla_lr_gbm <- tesla_lr
# Initialize
news0 <- tesla_filter$actual_close[n+1]
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma, 1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
for(i in 2:252){
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma,1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
print(news0)
}
print(sim)
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date > '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
length(tesla_lr)
####
#update new log return
## calculate new v and sigma
## generate s1
updateLR <- function(newS0, old_LR){
new_return <- log(news0) - old_LR[length(old_LR)]
return(c(old_LR[2:length(old_LR)],new_return))
}
generate_vsigma <-  function(logLR){
values<- c()
values$v = mean(logLR)/(1/252)
values$sigma = sd(logLR)/sqrt(1/252)
return(values)
}
gbm_s1 <- function(s0, v, sigma, Deltat){ ## 252
z = rnorm(1)
return(s0 *exp(v*Deltat+sigma*sqrt(Deltat)*z))
}
sim <- c()
tesla_lr_gbm <- tesla_lr
# Initialize
news0 <- tesla_filter$actual_close[n+1]
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma, 1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
for(i in 2:252){
val <- generate_vsigma(tesla_lr_gbm)
print(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma,1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
print(news0)
}
print(sim)
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date > '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
length(tesla_lr)
####
#update new log return
## calculate new v and sigma
## generate s1
updateLR <- function(newS0, old_LR){
new_return <- log(news0) - old_LR[length(old_LR)]
return(c(old_LR[2:length(old_LR)],new_return))
}
generate_vsigma <-  function(logLR){
values<- c()
values$v = mean(logLR)/(1/252)
values$sigma = sd(logLR)/sqrt(1/252)
return(values)
}
gbm_s1 <- function(s0, v, sigma, Deltat){ ## 252
z = rnorm(1)
return(s0 *exp(v*Deltat+sigma*sqrt(Deltat)*z))
}
sim <- c()
tesla_lr_gbm <- tesla_lr
# Initialize
news0 <- tesla_filter$actual_close[n+1]
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma, 1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
for(i in 2:20){
val <- generate_vsigma(tesla_lr_gbm)
print(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma,1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
print(news0)
}
print(sim)
########### Preparation of tesla data
library(dplyr)
library(fGarch)
setwd("C:/Users/neo qi xiang/Desktop/sim_finance/sim_finance_project")
tesla = read.csv("TSLA.csv")
tesla_filter <- subset(tesla, select = c('Date', 'Adj.Close'))
tesla_filter$Date <- as.Date(tesla_filter$Date)
tesla_filter$year <- format(tesla_filter$Date, format = "%Y")
tesla_filter$actual_close <- tesla_filter$Adj.Close*3
tesla_filter<- tesla_filter %>% filter(Date > '2021-01-12') %>% filter(Date <='2022-01-12')
n = length(tesla_filter$Adj.Close)-1
tesla_lr <-  log(tesla_filter$actual_close[2:n+1]) - log(tesla_filter$actual_close[1:n])
length(tesla_lr)
####
#update new log return
## calculate new v and sigma
## generate s1
updateLR <- function(newS0, old_LR){
new_return <- log(news0) - old_LR[length(old_LR)]
return(c(old_LR[2:length(old_LR)],new_return))
}
generate_vsigma <-  function(logLR){
values<- c()
values$v = mean(logLR)/(1/252)
values$sigma = sd(logLR)/sqrt(1/252)
return(values)
}
gbm_s1 <- function(s0, v, sigma, Deltat){ ## 252
z = rnorm(1)
return(s0 *exp(v*Deltat+sigma*sqrt(Deltat)*z))
}
sim <- c()
tesla_lr_gbm <- tesla_lr
# Initialize
news0 <- tesla_filter$actual_close[n+1]
val <- generate_vsigma(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma, 1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
for(i in 2:252){
val <- generate_vsigma(tesla_lr_gbm)
print(tesla_lr_gbm)
news0 <- gbm_s1(news0,val$v, val$sigma,1/252)
sim <- c(sim, news0)
tesla_lr_gbm <- updateLR(newS0,old_LR = tesla_lr_gbm)
print(val)
}
print(sim)
